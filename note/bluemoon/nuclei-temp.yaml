nuclei模板编写 格式说明:

# xxljob-default-login.yaml 例子
id: xxljob-default-login

info:
  name: XXL-JOB Default Login
  author: pdteam
  severity: high
  tags: default-login,xxljob
  reference: https://github.com/xuxueli/xxl-job

requests:
  - raw:
      - |
        POST /xxl-job-admin/login HTTP/1.1
        Host:{{Hostname}}
        Content-Type: application/x-www-form-urlencoded; charset=UTF-8

        userName={{username}}&password={{password}}
        
    payloads:
      username:
        - admin
      password:
        - 123456
    attack: pitchfork

    matchers-condition: and
    matchers:
      - type: word
        words:
          - '"code":200'
          - '"msg"'
          - '"content"'
        condition: and

      - type: word
        words:
          - 'application/json'
          - 'XXL_JOB_LOGIN_IDENTITY'
        part: header
        condition: and

        status:
          - 200


参数说明:
id info:
    id 
    # id是扫描模版的唯一标识，有cve、cnvd可以以cve id或是cnvd id命名

    info
    # 主要写基本信息，名称name、作者author、漏洞级别severity、出处reference等等

requests:
    raw
    # 需要原始http请求，body里的{{username}}和{{password}}对应payloads里的字段，
    # 即发送请求时会填入字段值，即实际请求为userName=admin&password=123456

    payloads
    # 匹配参数可以是特定的参数，也可以是path文件路径，用于Fuzz
        attack 指定爆破模式 同burpsuite Intruder
        # 即攻击类型，有batteringram、pitchfork、clusterbomb
            1.batteringram
            # 使用同一字典，将所有标记字段同时替换。如用户名和密码相同：
                    userName={{key}}&password={{key}}
                    
                payloads:
                  key:
                    - admin
                attack: batteringram

            2.pitchfork
            # 每个标记字段单独设置字典，按照一一对应的关系进行组合。如存在多个用户名密码，并且一一对应：
                    userName={{username}}&password={{password}}
                    
                payloads:
                  username:
                    - admin
                    - root
                  password:
                    - admin123
                    - password
                attack: pitchfork

            3.clusterbomb
            # 使用穷举法，对每个标记字段都遍历字典。如针对特定用户名进行爆破的情况：
                      userName={{username}}&password={{password}}

                  payloads:
                    username:
                      - admin
                      - root
                    password:
                      - password
                      - toor
                      - default
                      - 123456789
                  attack: clusterbomb

    matcher
    # 匹配器，主要用于设置匹配条件。

    # matchers-condition用于多个匹配条件的关联，and即需要满足所有匹配条件，or则是满足其中一个条件就算是true。

    # type里word即关键字匹配，part用于限制匹配的位置。status匹配状态码。























